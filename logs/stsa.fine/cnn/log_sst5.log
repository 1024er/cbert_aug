Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_0.1', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_1_4_3_0.1/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_0.1', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.411765
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15326
# test  data: 855
# vocab: 18621
# class: 5
epoch 0 augment best acc:0.404977
Epoch:  11%|█         | 1/9 [19:02<2:32:20, 1142.60s/it]constract vocabulary based on frequency
# train data: 15423
# test  data: 855
# vocab: 18661
# class: 5
epoch 1 augment best acc:0.420814
Epoch:  22%|██▏       | 2/9 [33:53<2:04:28, 1066.97s/it]constract vocabulary based on frequency
# train data: 15325
# test  data: 855
# vocab: 18521
# class: 5
epoch 2 augment best acc:0.409955
Epoch:  33%|███▎      | 3/9 [46:01<1:36:33, 965.55s/it] constract vocabulary based on frequency
# train data: 15374
# test  data: 855
# vocab: 18530
# class: 5
epoch 3 augment best acc:0.402715
Epoch:  44%|████▍     | 4/9 [1:00:57<1:18:42, 944.54s/it]constract vocabulary based on frequency
# train data: 15439
# test  data: 855
# vocab: 18498
# class: 5
epoch 4 augment best acc:0.40362
Epoch:  56%|█████▌    | 5/9 [1:19:07<1:05:52, 988.06s/it]constract vocabulary based on frequency
# train data: 15318
# test  data: 855
# vocab: 18475
# class: 5
epoch 5 augment best acc:0.373303
Epoch:  67%|██████▋   | 6/9 [1:37:35<51:12, 1024.03s/it] constract vocabulary based on frequency
# train data: 15381
# test  data: 855
# vocab: 18479
# class: 5
epoch 6 augment best acc:0.409502
Epoch:  78%|███████▊  | 7/9 [1:54:03<33:46, 1013.41s/it]constract vocabulary based on frequency
# train data: 15375
# test  data: 855
# vocab: 18462
# class: 5
epoch 7 augment best acc:0.425339
Epoch:  89%|████████▉ | 8/9 [2:08:05<16:02, 962.03s/it] constract vocabulary based on frequency
# train data: 15365
# test  data: 855
# vocab: 18459
# class: 5
epoch 8 augment best acc:0.404072
Epoch: 100%|██████████| 9/9 [2:22:49<00:00, 938.56s/it]Epoch: 100%|██████████| 9/9 [2:22:49<00:00, 952.18s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_0.5', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_1_4_3_0.5/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_0.5', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.407692
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15308
# test  data: 855
# vocab: 18747
# class: 5
epoch 0 augment best acc:0.406787
Epoch:  11%|█         | 1/9 [18:40<2:29:21, 1120.23s/it]constract vocabulary based on frequency
# train data: 15412
# test  data: 855
# vocab: 18708
# class: 5
epoch 1 augment best acc:0.420814
Epoch:  22%|██▏       | 2/9 [30:50<1:57:03, 1003.31s/it]constract vocabulary based on frequency
# train data: 15347
# test  data: 855
# vocab: 18588
# class: 5
epoch 2 augment best acc:0.40905
Epoch:  33%|███▎      | 3/9 [42:57<1:32:01, 920.26s/it] constract vocabulary based on frequency
# train data: 15383
# test  data: 855
# vocab: 18666
# class: 5
epoch 3 augment best acc:0.396833
Epoch:  44%|████▍     | 4/9 [1:01:12<1:21:03, 972.74s/it]constract vocabulary based on frequency
# train data: 15368
# test  data: 855
# vocab: 18523
# class: 5
epoch 4 augment best acc:0.41086
Epoch:  56%|█████▌    | 5/9 [1:19:23<1:07:12, 1008.17s/it]constract vocabulary based on frequency
# train data: 15448
# test  data: 855
# vocab: 18656
# class: 5
epoch 5 augment best acc:0.418552
Epoch:  67%|██████▋   | 6/9 [1:37:07<51:15, 1025.14s/it]  constract vocabulary based on frequency
# train data: 15307
# test  data: 855
# vocab: 18464
# class: 5
epoch 6 augment best acc:0.407692
Epoch:  78%|███████▊  | 7/9 [1:52:10<32:56, 988.42s/it] constract vocabulary based on frequency
# train data: 15450
# test  data: 855
# vocab: 18545
# class: 5
epoch 7 augment best acc:0.408597
Epoch:  89%|████████▉ | 8/9 [2:05:46<15:36, 936.75s/it]constract vocabulary based on frequency
# train data: 15302
# test  data: 855
# vocab: 18502
# class: 5
epoch 8 augment best acc:0.404072
Epoch: 100%|██████████| 9/9 [2:21:05<00:00, 931.39s/it]Epoch: 100%|██████████| 9/9 [2:21:05<00:00, 940.64s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_1.0', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_1_4_3_1.0/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_1.0', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.40543
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15331
# test  data: 855
# vocab: 19761
# class: 5
epoch 0 augment best acc:0.400452
Epoch:  11%|█         | 1/9 [19:27<2:35:40, 1167.54s/it]constract vocabulary based on frequency
# train data: 15390
# test  data: 855
# vocab: 19428
# class: 5
epoch 1 augment best acc:0.408145
Epoch:  22%|██▏       | 2/9 [36:06<2:10:18, 1116.95s/it]constract vocabulary based on frequency
# train data: 15375
# test  data: 855
# vocab: 19227
# class: 5
epoch 2 augment best acc:0.40543
Epoch:  33%|███▎      | 3/9 [48:12<1:39:57, 999.62s/it] constract vocabulary based on frequency
# train data: 15369
# test  data: 855
# vocab: 19154
# class: 5
epoch 3 augment best acc:0.403167
Epoch:  44%|████▍     | 4/9 [1:01:57<1:18:56, 947.29s/it]constract vocabulary based on frequency
# train data: 15389
# test  data: 855
# vocab: 18981
# class: 5
epoch 4 augment best acc:0.414932
Epoch:  56%|█████▌    | 5/9 [1:20:01<1:05:52, 988.18s/it]constract vocabulary based on frequency
# train data: 15388
# test  data: 855
# vocab: 18940
# class: 5
epoch 5 augment best acc:0.399548
Epoch:  67%|██████▋   | 6/9 [1:38:27<51:11, 1023.74s/it] constract vocabulary based on frequency
# train data: 15387
# test  data: 855
# vocab: 18952
# class: 5
epoch 6 augment best acc:0.414932
Epoch:  78%|███████▊  | 7/9 [1:56:11<34:31, 1035.59s/it]constract vocabulary based on frequency
# train data: 15384
# test  data: 855
# vocab: 18931
# class: 5
epoch 7 augment best acc:0.409502
Epoch:  89%|████████▉ | 8/9 [2:12:49<17:04, 1024.57s/it]constract vocabulary based on frequency
# train data: 15382
# test  data: 855
# vocab: 18856
# class: 5
epoch 8 augment best acc:0.413122
Epoch: 100%|██████████| 9/9 [2:27:45<00:00, 985.82s/it] Epoch: 100%|██████████| 9/9 [2:27:45<00:00, 985.03s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_0.1', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_1_6_2_0.1/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_0.1', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.41267
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15315
# test  data: 855
# vocab: 18025
# class: 5
epoch 0 augment best acc:0.407692
Epoch:  11%|█         | 1/9 [19:27<2:35:42, 1167.75s/it]constract vocabulary based on frequency
# train data: 15435
# test  data: 855
# vocab: 18003
# class: 5
epoch 1 augment best acc:0.399095
Epoch:  22%|██▏       | 2/9 [36:09<2:10:26, 1118.01s/it]constract vocabulary based on frequency
# train data: 15361
# test  data: 855
# vocab: 17977
# class: 5
epoch 2 augment best acc:0.400452
Epoch:  33%|███▎      | 3/9 [48:42<1:40:50, 1008.47s/it]constract vocabulary based on frequency
# train data: 15367
# test  data: 855
# vocab: 17972
# class: 5
epoch 3 augment best acc:0.38914
Epoch:  44%|████▍     | 4/9 [1:03:05<1:20:23, 964.79s/it]constract vocabulary based on frequency
# train data: 15388
# test  data: 855
# vocab: 17893
# class: 5
epoch 4 augment best acc:0.408597
Epoch:  56%|█████▌    | 5/9 [1:20:34<1:06:00, 990.10s/it]constract vocabulary based on frequency
# train data: 15369
# test  data: 855
# vocab: 17915
# class: 5
epoch 5 augment best acc:0.421719
Epoch:  67%|██████▋   | 6/9 [1:38:38<50:54, 1018.21s/it] constract vocabulary based on frequency
# train data: 15382
# test  data: 855
# vocab: 17950
# class: 5
epoch 6 augment best acc:0.39819
Epoch:  78%|███████▊  | 7/9 [1:55:53<34:06, 1023.37s/it]constract vocabulary based on frequency
# train data: 15382
# test  data: 855
# vocab: 17898
# class: 5
epoch 7 augment best acc:0.408597
Epoch:  89%|████████▉ | 8/9 [2:12:17<16:51, 1011.44s/it]constract vocabulary based on frequency
# train data: 15372
# test  data: 855
# vocab: 17896
# class: 5
epoch 8 augment best acc:0.415385
Epoch: 100%|██████████| 9/9 [2:26:58<00:00, 972.45s/it] Epoch: 100%|██████████| 9/9 [2:26:58<00:00, 979.88s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_0.5', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_1_6_2_0.5/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_0.5', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.408597
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15377
# test  data: 855
# vocab: 18107
# class: 5
epoch 0 augment best acc:0.403167
Epoch:  11%|█         | 1/9 [19:26<2:35:29, 1166.22s/it]constract vocabulary based on frequency
# train data: 15365
# test  data: 855
# vocab: 18070
# class: 5
epoch 1 augment best acc:0.41267
Epoch:  22%|██▏       | 2/9 [36:26<2:10:56, 1122.41s/it]constract vocabulary based on frequency
# train data: 15359
# test  data: 855
# vocab: 17979
# class: 5
epoch 2 augment best acc:0.408145
Epoch:  33%|███▎      | 3/9 [49:58<1:42:55, 1029.25s/it]constract vocabulary based on frequency
# train data: 15386
# test  data: 855
# vocab: 17950
# class: 5
epoch 3 augment best acc:0.404525
Epoch:  44%|████▍     | 4/9 [1:02:17<1:18:31, 942.21s/it]constract vocabulary based on frequency
# train data: 15374
# test  data: 855
# vocab: 17926
# class: 5
epoch 4 augment best acc:0.414932
Epoch:  56%|█████▌    | 5/9 [1:20:23<1:05:41, 985.31s/it]constract vocabulary based on frequency
# train data: 15371
# test  data: 855
# vocab: 17938
# class: 5
epoch 5 augment best acc:0.406787
Epoch:  67%|██████▋   | 6/9 [1:38:08<50:27, 1009.24s/it] constract vocabulary based on frequency
# train data: 15381
# test  data: 855
# vocab: 17940
# class: 5
epoch 6 augment best acc:0.422172
Epoch:  78%|███████▊  | 7/9 [1:55:15<33:49, 1014.59s/it]constract vocabulary based on frequency
# train data: 15390
# test  data: 855
# vocab: 17936
# class: 5
epoch 7 augment best acc:0.41991
Epoch:  89%|████████▉ | 8/9 [2:10:51<16:31, 991.13s/it] constract vocabulary based on frequency
# train data: 15356
# test  data: 855
# vocab: 17882
# class: 5
epoch 8 augment best acc:0.40181
Epoch: 100%|██████████| 9/9 [2:26:24<00:00, 973.67s/it]Epoch: 100%|██████████| 9/9 [2:26:24<00:00, 976.08s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_1.0', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_1_6_2_1.0/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_1.0', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.40181
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15332
# test  data: 855
# vocab: 18683
# class: 5
epoch 0 augment best acc:0.411765
Epoch:  11%|█         | 1/9 [19:27<2:35:37, 1167.24s/it]constract vocabulary based on frequency
# train data: 15387
# test  data: 855
# vocab: 18463
# class: 5
epoch 1 augment best acc:0.40724
Epoch:  22%|██▏       | 2/9 [37:09<2:12:30, 1135.81s/it]constract vocabulary based on frequency
# train data: 15353
# test  data: 855
# vocab: 18294
# class: 5
epoch 2 augment best acc:0.404977
Epoch:  33%|███▎      | 3/9 [51:46<1:45:47, 1057.97s/it]constract vocabulary based on frequency
# train data: 15401
# test  data: 855
# vocab: 18267
# class: 5
epoch 3 augment best acc:0.412217
Epoch:  44%|████▍     | 4/9 [1:02:56<1:18:28, 941.62s/it]constract vocabulary based on frequency
# train data: 15374
# test  data: 855
# vocab: 18167
# class: 5
epoch 4 augment best acc:0.404525
Epoch:  56%|█████▌    | 5/9 [1:20:14<1:04:42, 970.52s/it]constract vocabulary based on frequency
# train data: 15384
# test  data: 855
# vocab: 18202
# class: 5
epoch 5 augment best acc:0.40905
Epoch:  67%|██████▋   | 6/9 [1:38:06<50:03, 1001.02s/it] constract vocabulary based on frequency
# train data: 15376
# test  data: 855
# vocab: 18165
# class: 5
epoch 6 augment best acc:0.418552
Epoch:  78%|███████▊  | 7/9 [1:55:49<33:59, 1019.68s/it]constract vocabulary based on frequency
# train data: 15378
# test  data: 855
# vocab: 18109
# class: 5
epoch 7 augment best acc:0.410407
Epoch:  89%|████████▉ | 8/9 [2:12:53<17:00, 1020.84s/it]constract vocabulary based on frequency
# train data: 15369
# test  data: 855
# vocab: 18156
# class: 5
epoch 8 augment best acc:0.393213
Epoch: 100%|██████████| 9/9 [2:28:26<00:00, 994.68s/it] Epoch: 100%|██████████| 9/9 [2:28:26<00:00, 989.64s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_0.1', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_2_4_5_0.1/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_0.1', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.40905
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23049
# test  data: 855
# vocab: 18848
# class: 5
epoch 0 augment best acc:0.395475
Epoch:  11%|█         | 1/9 [20:15<2:42:02, 1215.35s/it]constract vocabulary based on frequency
# train data: 23068
# test  data: 855
# vocab: 18851
# class: 5
epoch 1 augment best acc:0.403167
Epoch:  22%|██▏       | 2/9 [39:27<2:19:35, 1196.53s/it]constract vocabulary based on frequency
# train data: 23061
# test  data: 855
# vocab: 18745
# class: 5
epoch 2 augment best acc:0.412217
Epoch:  33%|███▎      | 3/9 [58:23<1:57:50, 1178.38s/it]constract vocabulary based on frequency
# train data: 23039
# test  data: 855
# vocab: 18706
# class: 5
epoch 3 augment best acc:0.418552
Epoch:  44%|████▍     | 4/9 [1:12:32<1:29:56, 1079.37s/it]constract vocabulary based on frequency
# train data: 23112
# test  data: 855
# vocab: 18573
# class: 5
epoch 4 augment best acc:0.415385
Epoch:  56%|█████▌    | 5/9 [1:24:14<1:04:24, 966.15s/it] constract vocabulary based on frequency
# train data: 23009
# test  data: 855
# vocab: 18667
# class: 5
epoch 5 augment best acc:0.411765
Epoch:  67%|██████▋   | 6/9 [1:40:29<48:26, 968.83s/it]  constract vocabulary based on frequency
# train data: 23078
# test  data: 855
# vocab: 18629
# class: 5
epoch 6 augment best acc:0.4
Epoch:  78%|███████▊  | 7/9 [1:58:59<33:42, 1011.36s/it]constract vocabulary based on frequency
# train data: 23107
# test  data: 855
# vocab: 18545
# class: 5
epoch 7 augment best acc:0.412217
Epoch:  89%|████████▉ | 8/9 [2:16:21<17:00, 1020.49s/it]constract vocabulary based on frequency
# train data: 23016
# test  data: 855
# vocab: 18578
# class: 5
epoch 8 augment best acc:0.41086
Epoch: 100%|██████████| 9/9 [2:32:43<00:00, 1008.95s/it]Epoch: 100%|██████████| 9/9 [2:32:43<00:00, 1018.20s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_0.5', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_2_4_5_0.5/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_0.5', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.40724
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23002
# test  data: 855
# vocab: 19629
# class: 5
epoch 0 augment best acc:0.41629
Epoch:  11%|█         | 1/9 [20:43<2:45:50, 1243.81s/it]constract vocabulary based on frequency
# train data: 23075
# test  data: 855
# vocab: 19758
# class: 5
epoch 1 augment best acc:0.411765
Epoch:  22%|██▏       | 2/9 [39:48<2:21:39, 1214.16s/it]constract vocabulary based on frequency
# train data: 23078
# test  data: 855
# vocab: 19400
# class: 5
epoch 2 augment best acc:0.409955
Epoch:  33%|███▎      | 3/9 [59:08<1:59:46, 1197.73s/it]constract vocabulary based on frequency
# train data: 23049
# test  data: 855
# vocab: 19423
# class: 5
epoch 3 augment best acc:0.413122
Epoch:  44%|████▍     | 4/9 [1:15:42<1:34:43, 1136.65s/it]constract vocabulary based on frequency
# train data: 23129
# test  data: 855
# vocab: 19121
# class: 5
epoch 4 augment best acc:0.422172
Epoch:  56%|█████▌    | 5/9 [1:27:52<1:07:39, 1014.79s/it]constract vocabulary based on frequency
# train data: 23065
# test  data: 855
# vocab: 19243
# class: 5
epoch 5 augment best acc:0.404977
Epoch:  67%|██████▋   | 6/9 [1:41:57<48:11, 963.75s/it]   constract vocabulary based on frequency
# train data: 23008
# test  data: 855
# vocab: 19156
# class: 5
epoch 6 augment best acc:0.402715
Epoch:  78%|███████▊  | 7/9 [1:59:33<33:02, 991.39s/it]constract vocabulary based on frequency
# train data: 23062
# test  data: 855
# vocab: 19141
# class: 5
epoch 7 augment best acc:0.409502
Epoch:  89%|████████▉ | 8/9 [2:17:00<16:48, 1008.05s/it]constract vocabulary based on frequency
# train data: 23119
# test  data: 855
# vocab: 19104
# class: 5
epoch 8 augment best acc:0.401357
Epoch: 100%|██████████| 9/9 [2:32:37<00:00, 986.72s/it] Epoch: 100%|██████████| 9/9 [2:32:37<00:00, 1017.46s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_1.0', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_2_4_5_1.0/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_1.0', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.404977
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23058
# test  data: 855
# vocab: 22071
# class: 5
epoch 0 augment best acc:0.392308
Epoch:  11%|█         | 1/9 [20:24<2:43:15, 1224.47s/it]constract vocabulary based on frequency
# train data: 23020
# test  data: 855
# vocab: 21346
# class: 5
epoch 1 augment best acc:0.406787
Epoch:  22%|██▏       | 2/9 [39:26<2:19:58, 1199.81s/it]constract vocabulary based on frequency
# train data: 23038
# test  data: 855
# vocab: 20924
# class: 5
epoch 2 augment best acc:0.410407
Epoch:  33%|███▎      | 3/9 [59:06<1:59:22, 1193.67s/it]constract vocabulary based on frequency
# train data: 23086
# test  data: 855
# vocab: 20809
# class: 5
epoch 3 augment best acc:0.41629
Epoch:  44%|████▍     | 4/9 [1:17:30<1:37:13, 1166.77s/it]constract vocabulary based on frequency
# train data: 23057
# test  data: 855
# vocab: 20466
# class: 5
epoch 4 augment best acc:0.415385
Epoch:  56%|█████▌    | 5/9 [1:33:59<1:14:14, 1113.53s/it]constract vocabulary based on frequency
# train data: 23080
# test  data: 855
# vocab: 20528
# class: 5
epoch 5 augment best acc:0.408145
Epoch:  67%|██████▋   | 6/9 [1:47:31<51:09, 1023.22s/it]  constract vocabulary based on frequency
# train data: 23095
# test  data: 855
# vocab: 20427
# class: 5
epoch 6 augment best acc:0.399548
Epoch:  78%|███████▊  | 7/9 [2:03:31<33:28, 1004.01s/it]constract vocabulary based on frequency
# train data: 23063
# test  data: 855
# vocab: 20282
# class: 5
epoch 7 augment best acc:0.40905
Epoch:  89%|████████▉ | 8/9 [2:20:41<16:52, 1012.07s/it]constract vocabulary based on frequency
# train data: 23054
# test  data: 855
# vocab: 20175
# class: 5
epoch 8 augment best acc:0.380995
Epoch: 100%|██████████| 9/9 [2:35:22<00:00, 972.61s/it] Epoch: 100%|██████████| 9/9 [2:35:22<00:00, 1035.83s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_0.1', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_2_6_4_0.1/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_0.1', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.40543
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23037
# test  data: 855
# vocab: 18150
# class: 5
epoch 0 augment best acc:0.411765
Epoch:  11%|█         | 1/9 [20:03<2:40:25, 1203.14s/it]constract vocabulary based on frequency
# train data: 23079
# test  data: 855
# vocab: 18038
# class: 5
epoch 1 augment best acc:0.385068
Epoch:  22%|██▏       | 2/9 [40:05<2:20:20, 1202.89s/it]constract vocabulary based on frequency
# train data: 23025
# test  data: 855
# vocab: 17980
# class: 5
epoch 2 augment best acc:0.392308
Epoch:  33%|███▎      | 3/9 [1:00:10<2:00:21, 1203.58s/it]constract vocabulary based on frequency
# train data: 23080
# test  data: 855
# vocab: 17994
# class: 5
epoch 3 augment best acc:0.393665
Epoch:  44%|████▍     | 4/9 [1:19:01<1:38:28, 1181.73s/it]constract vocabulary based on frequency
# train data: 23113
# test  data: 855
# vocab: 17972
# class: 5
epoch 4 augment best acc:0.410407
Epoch:  56%|█████▌    | 5/9 [1:37:55<1:17:49, 1167.35s/it]constract vocabulary based on frequency
# train data: 23006
# test  data: 855
# vocab: 17993
# class: 5
epoch 5 augment best acc:0.423982
Epoch:  67%|██████▋   | 6/9 [1:56:13<57:20, 1146.73s/it]  constract vocabulary based on frequency
# train data: 23089
# test  data: 855
# vocab: 17991
# class: 5
epoch 6 augment best acc:0.374208
Epoch:  78%|███████▊  | 7/9 [2:14:46<37:53, 1136.66s/it]constract vocabulary based on frequency
# train data: 23105
# test  data: 855
# vocab: 17951
# class: 5
epoch 7 augment best acc:0.408597
Epoch:  89%|████████▉ | 8/9 [2:31:19<18:13, 1093.41s/it]constract vocabulary based on frequency
# train data: 23009
# test  data: 855
# vocab: 17937
# class: 5
epoch 8 augment best acc:0.417195
Epoch: 100%|██████████| 9/9 [2:40:36<00:00, 932.63s/it] Epoch: 100%|██████████| 9/9 [2:40:36<00:00, 1070.77s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_0.5', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_2_6_4_0.5/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_0.5', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.40724
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 22995
# test  data: 855
# vocab: 18572
# class: 5
epoch 0 augment best acc:0.40543
Epoch:  11%|█         | 1/9 [20:00<2:40:02, 1200.29s/it]constract vocabulary based on frequency
# train data: 23109
# test  data: 855
# vocab: 18490
# class: 5
epoch 1 augment best acc:0.414027
Epoch:  22%|██▏       | 2/9 [39:26<2:18:49, 1189.95s/it]constract vocabulary based on frequency
# train data: 23042
# test  data: 855
# vocab: 18394
# class: 5
epoch 2 augment best acc:0.399548
Epoch:  33%|███▎      | 3/9 [59:08<1:58:46, 1187.71s/it]constract vocabulary based on frequency
# train data: 23065
# test  data: 855
# vocab: 18368
# class: 5
epoch 3 augment best acc:0.403167
Epoch:  44%|████▍     | 4/9 [1:17:36<1:36:59, 1163.85s/it]constract vocabulary based on frequency
# train data: 23046
# test  data: 855
# vocab: 18169
# class: 5
epoch 4 augment best acc:0.40181
Epoch:  56%|█████▌    | 5/9 [1:35:19<1:15:34, 1133.61s/it]constract vocabulary based on frequency
# train data: 23082
# test  data: 855
# vocab: 18254
# class: 5
epoch 5 augment best acc:0.412217
Epoch:  67%|██████▋   | 6/9 [1:49:34<52:29, 1049.92s/it]  constract vocabulary based on frequency
# train data: 23066
# test  data: 855
# vocab: 18209
# class: 5
epoch 6 augment best acc:0.410407
Epoch:  78%|███████▊  | 7/9 [2:04:11<33:15, 997.91s/it] constract vocabulary based on frequency
# train data: 23072
# test  data: 855
# vocab: 18200
# class: 5
epoch 7 augment best acc:0.401357
Epoch:  89%|████████▉ | 8/9 [2:22:08<17:01, 1021.80s/it]constract vocabulary based on frequency
# train data: 23052
# test  data: 855
# vocab: 18211
# class: 5
epoch 8 augment best acc:0.407692
Epoch: 100%|██████████| 9/9 [2:34:31<00:00, 938.05s/it] Epoch: 100%|██████████| 9/9 [2:34:31<00:00, 1030.13s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_1.0', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_2_6_4_1.0/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_1.0', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.407692
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23046
# test  data: 855
# vocab: 19863
# class: 5
epoch 0 augment best acc:0.420362
Epoch:  11%|█         | 1/9 [20:18<2:42:31, 1218.90s/it]constract vocabulary based on frequency
# train data: 23084
# test  data: 855
# vocab: 19399
# class: 5
epoch 1 augment best acc:0.395475
Epoch:  22%|██▏       | 2/9 [40:17<2:21:30, 1212.88s/it]constract vocabulary based on frequency
# train data: 23051
# test  data: 855
# vocab: 18999
# class: 5
epoch 2 augment best acc:0.394118
Epoch:  33%|███▎      | 3/9 [1:00:23<2:01:05, 1210.85s/it]constract vocabulary based on frequency
# train data: 23068
# test  data: 855
# vocab: 19129
# class: 5
epoch 3 augment best acc:0.404525
Epoch:  44%|████▍     | 4/9 [1:19:36<1:39:26, 1193.36s/it]constract vocabulary based on frequency
# train data: 23062
# test  data: 855
# vocab: 18952
# class: 5
epoch 4 augment best acc:0.4
Epoch:  56%|█████▌    | 5/9 [1:38:49<1:18:45, 1181.33s/it]constract vocabulary based on frequency
# train data: 23067
# test  data: 855
# vocab: 18927
# class: 5
epoch 5 augment best acc:0.395928
Epoch:  67%|██████▋   | 6/9 [1:56:54<57:36, 1152.30s/it]  constract vocabulary based on frequency
# train data: 23089
# test  data: 855
# vocab: 18888
# class: 5
epoch 6 augment best acc:0.387783
Epoch:  78%|███████▊  | 7/9 [2:15:36<38:06, 1143.15s/it]constract vocabulary based on frequency
# train data: 23057
# test  data: 855
# vocab: 18823
# class: 5
epoch 7 augment best acc:0.39457
Epoch:  89%|████████▉ | 8/9 [2:32:16<18:20, 1100.28s/it]constract vocabulary based on frequency
# train data: 23000
# test  data: 855
# vocab: 18771
# class: 5
epoch 8 augment best acc:0.388688
Epoch: 100%|██████████| 9/9 [2:42:21<00:00, 951.77s/it] Epoch: 100%|██████████| 9/9 [2:42:21<00:00, 1082.39s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_0.1', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_3_4_7_0.1/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_0.1', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.409502
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30697
# test  data: 855
# vocab: 18923
# class: 5
epoch 0 augment best acc:0.40362
Epoch:  11%|█         | 1/9 [21:07<2:49:00, 1267.57s/it]constract vocabulary based on frequency
# train data: 30767
# test  data: 855
# vocab: 18945
# class: 5
epoch 1 augment best acc:0.421267
Epoch:  22%|██▏       | 2/9 [41:12<2:25:42, 1248.91s/it]constract vocabulary based on frequency
# train data: 30724
# test  data: 855
# vocab: 18793
# class: 5
epoch 2 augment best acc:0.397285
Epoch:  33%|███▎      | 3/9 [1:01:54<2:04:40, 1246.77s/it]constract vocabulary based on frequency
# train data: 30801
# test  data: 855
# vocab: 18840
# class: 5
epoch 3 augment best acc:0.399095
Epoch:  44%|████▍     | 4/9 [1:22:08<1:43:04, 1236.88s/it]constract vocabulary based on frequency
# train data: 30730
# test  data: 855
# vocab: 18627
# class: 5
epoch 4 augment best acc:0.41267
Epoch:  56%|█████▌    | 5/9 [1:40:26<1:19:41, 1195.28s/it]constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 18774
# class: 5
epoch 5 augment best acc:0.409955
Epoch:  67%|██████▋   | 6/9 [1:59:29<58:58, 1179.53s/it]  constract vocabulary based on frequency
# train data: 30782
# test  data: 855
# vocab: 18684
# class: 5
epoch 6 augment best acc:0.400452
Epoch:  78%|███████▊  | 7/9 [2:17:53<38:33, 1156.78s/it]constract vocabulary based on frequency
# train data: 30758
# test  data: 855
# vocab: 18602
# class: 5
epoch 7 augment best acc:0.39095
Epoch:  89%|████████▉ | 8/9 [2:34:38<18:31, 1111.45s/it]constract vocabulary based on frequency
# train data: 30770
# test  data: 855
# vocab: 18672
# class: 5
epoch 8 augment best acc:0.4181
Epoch: 100%|██████████| 9/9 [2:45:20<00:00, 970.62s/it] Epoch: 100%|██████████| 9/9 [2:45:20<00:00, 1102.32s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_0.5', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_3_4_7_0.5/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_0.5', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.410407
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30704
# test  data: 855
# vocab: 20413
# class: 5
epoch 0 augment best acc:0.41991
Epoch:  11%|█         | 1/9 [20:54<2:47:13, 1254.24s/it]constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 20326
# class: 5
epoch 1 augment best acc:0.392308
Epoch:  22%|██▏       | 2/9 [40:59<2:24:37, 1239.67s/it]constract vocabulary based on frequency
# train data: 30790
# test  data: 855
# vocab: 19983
# class: 5
epoch 2 augment best acc:0.402262
Epoch:  33%|███▎      | 3/9 [1:00:52<2:02:33, 1225.56s/it]constract vocabulary based on frequency
# train data: 30776
# test  data: 855
# vocab: 19981
# class: 5
epoch 3 augment best acc:0.411312
Epoch:  44%|████▍     | 4/9 [1:20:29<1:40:55, 1211.11s/it]constract vocabulary based on frequency
# train data: 30737
# test  data: 855
# vocab: 19678
# class: 5
epoch 4 augment best acc:0.39638
Epoch:  56%|█████▌    | 5/9 [1:39:32<1:19:21, 1190.42s/it]constract vocabulary based on frequency
# train data: 30710
# test  data: 855
# vocab: 19850
# class: 5
epoch 5 augment best acc:0.411765
Epoch:  67%|██████▋   | 6/9 [1:58:22<58:37, 1172.48s/it]  constract vocabulary based on frequency
# train data: 30824
# test  data: 855
# vocab: 19782
# class: 5
epoch 6 augment best acc:0.404977
Epoch:  78%|███████▊  | 7/9 [2:17:07<38:36, 1158.28s/it]constract vocabulary based on frequency
# train data: 30701
# test  data: 855
# vocab: 19687
# class: 5
epoch 7 augment best acc:0.402262
Epoch:  89%|████████▉ | 8/9 [2:33:40<18:28, 1108.51s/it]constract vocabulary based on frequency
# train data: 30808
# test  data: 855
# vocab: 19596
# class: 5
epoch 8 augment best acc:0.411765
Epoch: 100%|██████████| 9/9 [2:44:32<00:00, 971.63s/it] Epoch: 100%|██████████| 9/9 [2:44:32<00:00, 1096.94s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_1.0', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_3_4_7_1.0/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_1.0', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:56 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:56 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:56 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:56 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:56 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:56 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:56 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:56 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:56 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:56 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.409955
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30690
# test  data: 855
# vocab: 24225
# class: 5
epoch 0 augment best acc:0.417195
Epoch:  11%|█         | 1/9 [20:50<2:46:42, 1250.32s/it]constract vocabulary based on frequency
# train data: 30817
# test  data: 855
# vocab: 23178
# class: 5
epoch 1 augment best acc:0.408145
Epoch:  22%|██▏       | 2/9 [40:20<2:23:03, 1226.20s/it]constract vocabulary based on frequency
# train data: 30728
# test  data: 855
# vocab: 22350
# class: 5
epoch 2 augment best acc:0.406335
Epoch:  33%|███▎      | 3/9 [1:00:05<2:01:22, 1213.83s/it]constract vocabulary based on frequency
# train data: 30748
# test  data: 855
# vocab: 22180
# class: 5
epoch 3 augment best acc:0.401357
Epoch:  44%|████▍     | 4/9 [1:19:19<1:39:39, 1195.83s/it]constract vocabulary based on frequency
# train data: 30761
# test  data: 855
# vocab: 21630
# class: 5
epoch 4 augment best acc:0.40362
Epoch:  56%|█████▌    | 5/9 [1:37:55<1:18:07, 1171.88s/it]constract vocabulary based on frequency
# train data: 30784
# test  data: 855
# vocab: 21842
# class: 5
epoch 5 augment best acc:0.406335
Epoch:  67%|██████▋   | 6/9 [1:56:34<57:48, 1156.24s/it]  constract vocabulary based on frequency
# train data: 30713
# test  data: 855
# vocab: 21865
# class: 5
epoch 6 augment best acc:0.421267
Epoch:  78%|███████▊  | 7/9 [2:14:53<37:57, 1138.94s/it]constract vocabulary based on frequency
# train data: 30760
# test  data: 855
# vocab: 21703
# class: 5
epoch 7 augment best acc:0.402715
Epoch:  89%|████████▉ | 8/9 [2:32:12<18:28, 1108.86s/it]constract vocabulary based on frequency
# train data: 30745
# test  data: 855
# vocab: 21427
# class: 5
epoch 8 augment best acc:0.401357
Epoch: 100%|██████████| 9/9 [2:42:57<00:00, 969.73s/it] Epoch: 100%|██████████| 9/9 [2:42:57<00:00, 1086.35s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_0.1', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_3_6_6_0.1/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_0.1', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.1, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.409955
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30723
# test  data: 855
# vocab: 18207
# class: 5
epoch 0 augment best acc:0.40724
Epoch:  11%|█         | 1/9 [20:52<2:47:01, 1252.71s/it]constract vocabulary based on frequency
# train data: 30746
# test  data: 855
# vocab: 18107
# class: 5
epoch 1 augment best acc:0.40362
Epoch:  22%|██▏       | 2/9 [40:29<2:23:29, 1230.00s/it]constract vocabulary based on frequency
# train data: 30795
# test  data: 855
# vocab: 18029
# class: 5
epoch 2 augment best acc:0.39638
Epoch:  33%|███▎      | 3/9 [1:00:40<2:02:26, 1224.34s/it]constract vocabulary based on frequency
# train data: 30731
# test  data: 855
# vocab: 18065
# class: 5
epoch 3 augment best acc:0.394118
Epoch:  44%|████▍     | 4/9 [1:21:10<1:42:09, 1225.86s/it]constract vocabulary based on frequency
# train data: 30784
# test  data: 855
# vocab: 18006
# class: 5
epoch 4 augment best acc:0.395928
Epoch:  56%|█████▌    | 5/9 [1:40:05<1:19:54, 1198.61s/it]constract vocabulary based on frequency
# train data: 30733
# test  data: 855
# vocab: 17983
# class: 5
epoch 5 augment best acc:0.359276
Epoch:  67%|██████▋   | 6/9 [2:02:25<1:02:03, 1241.01s/it]constract vocabulary based on frequency
# train data: 30768
# test  data: 855
# vocab: 18027
# class: 5
epoch 6 augment best acc:0.418552
Epoch:  78%|███████▊  | 7/9 [2:20:19<39:42, 1191.05s/it]  constract vocabulary based on frequency
# train data: 30760
# test  data: 855
# vocab: 17975
# class: 5
epoch 7 augment best acc:0.40181
Epoch:  89%|████████▉ | 8/9 [2:34:55<18:16, 1096.46s/it]constract vocabulary based on frequency
# train data: 30756
# test  data: 855
# vocab: 17961
# class: 5
epoch 8 augment best acc:0.422172
Epoch: 100%|██████████| 9/9 [2:44:37<00:00, 942.16s/it] Epoch: 100%|██████████| 9/9 [2:44:37<00:00, 1097.51s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_0.5', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_3_6_6_0.5/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_0.5', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.405882
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30701
# test  data: 855
# vocab: 19059
# class: 5
epoch 0 augment best acc:0.393213
Epoch:  11%|█         | 1/9 [22:00<2:56:04, 1320.53s/it]constract vocabulary based on frequency
# train data: 30782
# test  data: 855
# vocab: 18839
# class: 5
epoch 1 augment best acc:0.403167
Epoch:  22%|██▏       | 2/9 [41:02<2:27:47, 1266.84s/it]constract vocabulary based on frequency
# train data: 30773
# test  data: 855
# vocab: 18549
# class: 5
epoch 2 augment best acc:0.41448
Epoch:  33%|███▎      | 3/9 [1:00:31<2:03:44, 1237.50s/it]constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 18639
# class: 5
epoch 3 augment best acc:0.406335
Epoch:  44%|████▍     | 4/9 [1:20:09<1:41:38, 1219.63s/it]constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 18480
# class: 5
epoch 4 augment best acc:0.386425
Epoch:  56%|█████▌    | 5/9 [1:40:34<1:21:25, 1221.42s/it]constract vocabulary based on frequency
# train data: 30746
# test  data: 855
# vocab: 18560
# class: 5
epoch 5 augment best acc:0.413122
Epoch:  67%|██████▋   | 6/9 [1:58:56<59:16, 1185.52s/it]  constract vocabulary based on frequency
# train data: 30777
# test  data: 855
# vocab: 18431
# class: 5
epoch 6 augment best acc:0.416742
Epoch:  78%|███████▊  | 7/9 [2:17:11<38:36, 1158.49s/it]constract vocabulary based on frequency
# train data: 30745
# test  data: 855
# vocab: 18420
# class: 5
epoch 7 augment best acc:0.41086
Epoch:  89%|████████▉ | 8/9 [2:34:03<18:34, 1114.46s/it]constract vocabulary based on frequency
# train data: 30696
# test  data: 855
# vocab: 18449
# class: 5
epoch 8 augment best acc:0.406787
Epoch: 100%|██████████| 9/9 [2:44:13<00:00, 963.04s/it] Epoch: 100%|██████████| 9/9 [2:44:13<00:00, 1094.81s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_1.0', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
Traceback (most recent call last):
  File "aug_dataset.py", line 392, in <module>
    main()
  File "aug_dataset.py", line 286, in main
    run_aug(args, save_every_epoch=False)
  File "aug_dataset.py", line 309, in run_aug
    shutil.copytree("aug_data/{}".format(task_name), args.output_dir)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/shutil.py", line 315, in copytree
    os.makedirs(dst)
  File "/workspace/miniconda3/envs/py35/lib/python3.5/os.py", line 241, in makedirs
    mkdir(name, mode)
FileExistsError: [Errno 17] File exists: 'aug_data_3_6_6_1.0/stsa.fine'
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_1.0', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/25/2019 05:23:54 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/25/2019 05:23:55 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-1
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:55 - INFO - __main__ -   *** Example ***
10/25/2019 05:23:55 - INFO - __main__ -   guid: train-2
10/25/2019 05:23:55 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/25/2019 05:23:55 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/25/2019 05:23:55 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/25/2019 05:23:59 - INFO - __main__ -   ***** Running training *****
10/25/2019 05:23:59 - INFO - __main__ -     Num examples = 7689
10/25/2019 05:23:59 - INFO - __main__ -     Batch size = 32
10/25/2019 05:23:59 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.410407
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30742
# test  data: 855
# vocab: 21203
# class: 5
epoch 0 augment best acc:0.411312
Epoch:  11%|█         | 1/9 [20:40<2:45:20, 1240.11s/it]constract vocabulary based on frequency
# train data: 30725
# test  data: 855
# vocab: 20342
# class: 5
epoch 1 augment best acc:0.4
Epoch:  22%|██▏       | 2/9 [39:59<2:21:50, 1215.85s/it]constract vocabulary based on frequency
# train data: 30720
# test  data: 855
# vocab: 19870
# class: 5
epoch 2 augment best acc:0.409955
Epoch:  33%|███▎      | 3/9 [59:20<1:59:56, 1199.41s/it]constract vocabulary based on frequency
# train data: 30770
# test  data: 855
# vocab: 19770
# class: 5
epoch 3 augment best acc:0.411312
Epoch:  44%|████▍     | 4/9 [1:17:12<1:36:45, 1161.09s/it]constract vocabulary based on frequency
# train data: 30773
# test  data: 855
# vocab: 19629
# class: 5
epoch 4 augment best acc:0.417195
Epoch:  56%|█████▌    | 5/9 [1:31:57<1:11:54, 1078.52s/it]constract vocabulary based on frequency
# train data: 30755
# test  data: 855
# vocab: 19611
# class: 5
epoch 5 augment best acc:0.380543
Epoch:  67%|██████▋   | 6/9 [1:46:45<51:03, 1021.16s/it]  constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 19527
# class: 5
epoch 6 augment best acc:0.415837
Epoch:  78%|███████▊  | 7/9 [2:02:58<33:33, 1006.80s/it]constract vocabulary based on frequency
# train data: 30764
# test  data: 855
# vocab: 19478
# class: 5
epoch 7 augment best acc:0.40181
Epoch:  89%|████████▉ | 8/9 [2:20:41<17:03, 1023.57s/it]constract vocabulary based on frequency
# train data: 30763
# test  data: 855
# vocab: 19490
# class: 5
epoch 8 augment best acc:0.407692
Epoch: 100%|██████████| 9/9 [2:35:02<00:00, 974.95s/it] Epoch: 100%|██████████| 9/9 [2:35:02<00:00, 1033.64s/it]
