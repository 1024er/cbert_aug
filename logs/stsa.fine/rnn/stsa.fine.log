Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_0.5', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15373
# test  data: 855
# vocab: 18722
# class: 5
epoch 0 augment best acc:0.404072
Epoch:  11%|█         | 1/9 [11:08<1:29:10, 668.77s/it]constract vocabulary based on frequency
# train data: 15359
# test  data: 855
# vocab: 18715
# class: 5
epoch 1 augment best acc:0.413575
Epoch:  22%|██▏       | 2/9 [18:30<1:10:04, 600.70s/it]constract vocabulary based on frequency
# train data: 15346
# test  data: 855
# vocab: 18628
# class: 5
epoch 2 augment best acc:0.409502
Epoch:  33%|███▎      | 3/9 [27:15<57:48, 578.06s/it]  constract vocabulary based on frequency
# train data: 15370
# test  data: 855
# vocab: 18656
# class: 5
epoch 3 augment best acc:0.39638
Epoch:  44%|████▍     | 4/9 [35:49<46:33, 558.72s/it]constract vocabulary based on frequency
# train data: 15434
# test  data: 855
# vocab: 18613
# class: 5
epoch 4 augment best acc:0.40724
Epoch:  56%|█████▌    | 5/9 [44:45<36:48, 552.01s/it]constract vocabulary based on frequency
# train data: 15326
# test  data: 855
# vocab: 18574
# class: 5
epoch 5 augment best acc:0.389593
Epoch:  67%|██████▋   | 6/9 [52:49<26:34, 531.39s/it]constract vocabulary based on frequency
# train data: 15373
# test  data: 855
# vocab: 18530
# class: 5
epoch 6 augment best acc:0.414027
Epoch:  78%|███████▊  | 7/9 [1:01:49<17:48, 534.11s/it]constract vocabulary based on frequency
# train data: 15380
# test  data: 855
# vocab: 18540
# class: 5
epoch 7 augment best acc:0.418552
Epoch:  89%|████████▉ | 8/9 [1:10:24<08:48, 528.33s/it]constract vocabulary based on frequency
# train data: 15437
# test  data: 855
# vocab: 18462
# class: 5
epoch 8 augment best acc:0.418552
Epoch: 100%|██████████| 9/9 [1:16:44<00:00, 483.96s/it]Epoch: 100%|██████████| 9/9 [1:16:44<00:00, 511.65s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=3, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_4_3_1.0', sample_num=1, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15331
# test  data: 855
# vocab: 19788
# class: 5
epoch 0 augment best acc:0.411312
Epoch:  11%|█         | 1/9 [11:33<1:32:31, 693.97s/it]constract vocabulary based on frequency
# train data: 15387
# test  data: 855
# vocab: 19384
# class: 5
epoch 1 augment best acc:0.41086
Epoch:  22%|██▏       | 2/9 [19:06<1:12:31, 621.65s/it]constract vocabulary based on frequency
# train data: 15375
# test  data: 855
# vocab: 19207
# class: 5
epoch 2 augment best acc:0.419457
Epoch:  33%|███▎      | 3/9 [28:25<1:00:15, 602.60s/it]constract vocabulary based on frequency
# train data: 15386
# test  data: 855
# vocab: 19115
# class: 5
epoch 3 augment best acc:0.409502
Epoch:  44%|████▍     | 4/9 [36:29<47:16, 567.26s/it]  constract vocabulary based on frequency
# train data: 15379
# test  data: 855
# vocab: 18934
# class: 5
epoch 4 augment best acc:0.412217
Epoch:  56%|█████▌    | 5/9 [44:29<36:03, 540.86s/it]constract vocabulary based on frequency
# train data: 15373
# test  data: 855
# vocab: 18987
# class: 5
epoch 5 augment best acc:0.403167
Epoch:  67%|██████▋   | 6/9 [51:37<25:21, 507.23s/it]constract vocabulary based on frequency
# train data: 15402
# test  data: 855
# vocab: 19016
# class: 5
epoch 6 augment best acc:0.411312
Epoch:  78%|███████▊  | 7/9 [1:00:26<17:07, 513.67s/it]constract vocabulary based on frequency
# train data: 15371
# test  data: 855
# vocab: 18960
# class: 5
epoch 7 augment best acc:0.415385
Epoch:  89%|████████▉ | 8/9 [1:09:00<08:33, 513.79s/it]constract vocabulary based on frequency
# train data: 15372
# test  data: 855
# vocab: 18826
# class: 5
epoch 8 augment best acc:0.418552
Epoch: 100%|██████████| 9/9 [1:16:42<00:00, 498.17s/it]Epoch: 100%|██████████| 9/9 [1:16:42<00:00, 511.37s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_0.5', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15307
# test  data: 855
# vocab: 18098
# class: 5
epoch 0 augment best acc:0.39276
Epoch:  11%|█         | 1/9 [11:56<1:35:35, 716.88s/it]constract vocabulary based on frequency
# train data: 15431
# test  data: 855
# vocab: 18029
# class: 5
epoch 1 augment best acc:0.421267
Epoch:  22%|██▏       | 2/9 [19:39<1:14:44, 640.65s/it]constract vocabulary based on frequency
# train data: 15359
# test  data: 855
# vocab: 18023
# class: 5
epoch 2 augment best acc:0.401357
Epoch:  33%|███▎      | 3/9 [26:47<57:41, 576.94s/it]  constract vocabulary based on frequency
# train data: 15387
# test  data: 855
# vocab: 18010
# class: 5
epoch 3 augment best acc:0.420362
Epoch:  44%|████▍     | 4/9 [35:24<46:34, 558.82s/it]constract vocabulary based on frequency
# train data: 15367
# test  data: 855
# vocab: 17894
# class: 5
epoch 4 augment best acc:0.411765
Epoch:  56%|█████▌    | 5/9 [43:45<36:05, 541.44s/it]constract vocabulary based on frequency
# train data: 15386
# test  data: 855
# vocab: 17927
# class: 5
epoch 5 augment best acc:0.403167
Epoch:  67%|██████▋   | 6/9 [50:40<25:10, 503.50s/it]constract vocabulary based on frequency
# train data: 15382
# test  data: 855
# vocab: 17964
# class: 5
epoch 6 augment best acc:0.413122
Epoch:  78%|███████▊  | 7/9 [59:29<17:02, 511.29s/it]constract vocabulary based on frequency
# train data: 15377
# test  data: 855
# vocab: 17937
# class: 5
epoch 7 augment best acc:0.414027
Epoch:  89%|████████▉ | 8/9 [1:08:19<08:36, 516.89s/it]constract vocabulary based on frequency
# train data: 15367
# test  data: 855
# vocab: 17898
# class: 5
epoch 8 augment best acc:0.40181
Epoch: 100%|██████████| 9/9 [1:13:52<00:00, 461.64s/it]Epoch: 100%|██████████| 9/9 [1:13:52<00:00, 492.50s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=2, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_1_6_2_1.0', sample_num=1, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 15315
# test  data: 855
# vocab: 18688
# class: 5
epoch 0 augment best acc:0.404072
Epoch:  11%|█         | 1/9 [11:04<1:28:37, 664.69s/it]constract vocabulary based on frequency
# train data: 15389
# test  data: 855
# vocab: 18403
# class: 5
epoch 1 augment best acc:0.397285
Epoch:  22%|██▏       | 2/9 [17:02<1:06:48, 572.61s/it]constract vocabulary based on frequency
# train data: 15371
# test  data: 855
# vocab: 18270
# class: 5
epoch 2 augment best acc:0.404072
Epoch:  33%|███▎      | 3/9 [25:18<54:57, 549.60s/it]  constract vocabulary based on frequency
# train data: 15390
# test  data: 855
# vocab: 18238
# class: 5
epoch 3 augment best acc:0.411312
Epoch:  44%|████▍     | 4/9 [34:32<45:55, 551.10s/it]constract vocabulary based on frequency
# train data: 15371
# test  data: 855
# vocab: 18207
# class: 5
epoch 4 augment best acc:0.405882
Epoch:  56%|█████▌    | 5/9 [43:08<36:01, 540.46s/it]constract vocabulary based on frequency
# train data: 15396
# test  data: 855
# vocab: 18178
# class: 5
epoch 5 augment best acc:0.39638
Epoch:  67%|██████▋   | 6/9 [50:00<25:05, 501.75s/it]constract vocabulary based on frequency
# train data: 15378
# test  data: 855
# vocab: 18119
# class: 5
epoch 6 augment best acc:0.417647
Epoch:  78%|███████▊  | 7/9 [58:19<16:42, 501.14s/it]constract vocabulary based on frequency
# train data: 15382
# test  data: 855
# vocab: 18174
# class: 5
epoch 7 augment best acc:0.41448
Epoch:  89%|████████▉ | 8/9 [1:04:25<07:40, 460.58s/it]constract vocabulary based on frequency
# train data: 15359
# test  data: 855
# vocab: 18138
# class: 5
epoch 8 augment best acc:0.410407
Epoch: 100%|██████████| 9/9 [1:11:47<00:00, 454.81s/it]Epoch: 100%|██████████| 9/9 [1:11:47<00:00, 478.56s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_0.5', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23006
# test  data: 855
# vocab: 19685
# class: 5
epoch 0 augment best acc:0.41267
Epoch:  11%|█         | 1/9 [12:58<1:43:44, 778.05s/it]constract vocabulary based on frequency
# train data: 23082
# test  data: 855
# vocab: 19573
# class: 5
epoch 1 augment best acc:0.411765
Epoch:  22%|██▏       | 2/9 [23:46<1:26:13, 739.09s/it]constract vocabulary based on frequency
# train data: 23068
# test  data: 855
# vocab: 19339
# class: 5
epoch 2 augment best acc:0.413122
Epoch:  33%|███▎      | 3/9 [33:28<1:09:11, 691.96s/it]constract vocabulary based on frequency
# train data: 23111
# test  data: 855
# vocab: 19361
# class: 5
epoch 3 augment best acc:0.393213
Epoch:  44%|████▍     | 4/9 [41:46<52:49, 633.85s/it]  constract vocabulary based on frequency
# train data: 23058
# test  data: 855
# vocab: 19219
# class: 5
epoch 4 augment best acc:0.400905
Epoch:  56%|█████▌    | 5/9 [50:28<40:00, 600.24s/it]constract vocabulary based on frequency
# train data: 23007
# test  data: 855
# vocab: 19223
# class: 5
epoch 5 augment best acc:0.408597
Epoch:  67%|██████▋   | 6/9 [1:01:25<30:51, 617.25s/it]constract vocabulary based on frequency
# train data: 23070
# test  data: 855
# vocab: 19151
# class: 5
epoch 6 augment best acc:0.39095
Epoch:  78%|███████▊  | 7/9 [1:11:14<20:17, 608.82s/it]constract vocabulary based on frequency
# train data: 23130
# test  data: 855
# vocab: 19213
# class: 5
epoch 7 augment best acc:0.409955
Epoch:  89%|████████▉ | 8/9 [1:21:02<10:02, 602.52s/it]constract vocabulary based on frequency
# train data: 23070
# test  data: 855
# vocab: 19107
# class: 5
epoch 8 augment best acc:0.4
Epoch: 100%|██████████| 9/9 [1:28:13<00:00, 551.17s/it]Epoch: 100%|██████████| 9/9 [1:28:13<00:00, 588.17s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=5, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_4_5_1.0', sample_num=2, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23059
# test  data: 855
# vocab: 22106
# class: 5
epoch 0 augment best acc:0.40905
Epoch:  11%|█         | 1/9 [13:00<1:44:06, 780.87s/it]constract vocabulary based on frequency
# train data: 23010
# test  data: 855
# vocab: 21250
# class: 5
epoch 1 augment best acc:0.390498
Epoch:  22%|██▏       | 2/9 [23:33<1:25:53, 736.26s/it]constract vocabulary based on frequency
# train data: 23131
# test  data: 855
# vocab: 20947
# class: 5
epoch 2 augment best acc:0.426244
Epoch:  33%|███▎      | 3/9 [33:40<1:09:45, 697.64s/it]constract vocabulary based on frequency
# train data: 23002
# test  data: 855
# vocab: 20730
# class: 5
epoch 3 augment best acc:0.411765
Epoch:  44%|████▍     | 4/9 [42:44<54:17, 651.43s/it]  constract vocabulary based on frequency
# train data: 23061
# test  data: 855
# vocab: 20440
# class: 5
epoch 4 augment best acc:0.40724
Epoch:  56%|█████▌    | 5/9 [52:18<41:53, 628.38s/it]constract vocabulary based on frequency
# train data: 23080
# test  data: 855
# vocab: 20565
# class: 5
epoch 5 augment best acc:0.410407
Epoch:  67%|██████▋   | 6/9 [1:02:43<31:21, 627.21s/it]constract vocabulary based on frequency
# train data: 23093
# test  data: 855
# vocab: 20483
# class: 5
epoch 6 augment best acc:0.404977
Epoch:  78%|███████▊  | 7/9 [1:13:17<20:58, 629.27s/it]constract vocabulary based on frequency
# train data: 23059
# test  data: 855
# vocab: 20298
# class: 5
epoch 7 augment best acc:0.405882
Epoch:  89%|████████▉ | 8/9 [1:20:13<09:25, 565.48s/it]constract vocabulary based on frequency
# train data: 23047
# test  data: 855
# vocab: 20294
# class: 5
epoch 8 augment best acc:0.411765
Epoch: 100%|██████████| 9/9 [1:27:41<00:00, 529.99s/it]Epoch: 100%|██████████| 9/9 [1:27:41<00:00, 584.57s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_0.5', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23019
# test  data: 855
# vocab: 18600
# class: 5
epoch 0 augment best acc:0.419005
Epoch:  11%|█         | 1/9 [13:14<1:45:54, 794.29s/it]constract vocabulary based on frequency
# train data: 23089
# test  data: 855
# vocab: 18486
# class: 5
epoch 1 augment best acc:0.410407
Epoch:  22%|██▏       | 2/9 [24:02<1:27:32, 750.39s/it]constract vocabulary based on frequency
# train data: 23034
# test  data: 855
# vocab: 18355
# class: 5
epoch 2 augment best acc:0.40181
Epoch:  33%|███▎      | 3/9 [33:27<1:09:28, 694.74s/it]constract vocabulary based on frequency
# train data: 23063
# test  data: 855
# vocab: 18364
# class: 5
epoch 3 augment best acc:0.395928
Epoch:  44%|████▍     | 4/9 [41:32<52:39, 631.95s/it]  constract vocabulary based on frequency
# train data: 23052
# test  data: 855
# vocab: 18226
# class: 5
epoch 4 augment best acc:0.411765
Epoch:  56%|█████▌    | 5/9 [50:05<39:44, 596.18s/it]constract vocabulary based on frequency
# train data: 23083
# test  data: 855
# vocab: 18244
# class: 5
epoch 5 augment best acc:0.40905
Epoch:  67%|██████▋   | 6/9 [1:00:04<29:51, 597.15s/it]constract vocabulary based on frequency
# train data: 23067
# test  data: 855
# vocab: 18212
# class: 5
epoch 6 augment best acc:0.412217
Epoch:  78%|███████▊  | 7/9 [1:10:16<20:03, 601.55s/it]constract vocabulary based on frequency
# train data: 23070
# test  data: 855
# vocab: 18224
# class: 5
epoch 7 augment best acc:0.424434
Epoch:  89%|████████▉ | 8/9 [1:18:19<09:25, 565.87s/it]constract vocabulary based on frequency
# train data: 23062
# test  data: 855
# vocab: 18208
# class: 5
epoch 8 augment best acc:0.40362
Epoch: 100%|██████████| 9/9 [1:25:04<00:00, 517.56s/it]Epoch: 100%|██████████| 9/9 [1:25:04<00:00, 567.11s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=4, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_2_6_4_1.0', sample_num=2, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 23036
# test  data: 855
# vocab: 19995
# class: 5
epoch 0 augment best acc:0.419457
Epoch:  11%|█         | 1/9 [12:56<1:43:28, 776.08s/it]constract vocabulary based on frequency
# train data: 23086
# test  data: 855
# vocab: 19386
# class: 5
epoch 1 augment best acc:0.408597
Epoch:  22%|██▏       | 2/9 [24:31<1:27:42, 751.75s/it]constract vocabulary based on frequency
# train data: 23046
# test  data: 855
# vocab: 19080
# class: 5
epoch 2 augment best acc:0.415385
Epoch:  33%|███▎      | 3/9 [35:14<1:11:55, 719.18s/it]constract vocabulary based on frequency
# train data: 23082
# test  data: 855
# vocab: 19067
# class: 5
epoch 3 augment best acc:0.409502
Epoch:  44%|████▍     | 4/9 [46:07<58:16, 699.30s/it]  constract vocabulary based on frequency
# train data: 23059
# test  data: 855
# vocab: 19007
# class: 5
epoch 4 augment best acc:0.39457
Epoch:  56%|█████▌    | 5/9 [54:09<42:17, 634.29s/it]constract vocabulary based on frequency
# train data: 23072
# test  data: 855
# vocab: 18974
# class: 5
epoch 5 augment best acc:0.386425
Epoch:  67%|██████▋   | 6/9 [1:02:24<29:37, 592.53s/it]constract vocabulary based on frequency
# train data: 23088
# test  data: 855
# vocab: 18887
# class: 5
epoch 6 augment best acc:0.410407
Epoch:  78%|███████▊  | 7/9 [1:15:54<21:55, 657.63s/it]constract vocabulary based on frequency
# train data: 23062
# test  data: 855
# vocab: 18809
# class: 5
epoch 7 augment best acc:0.404977
Epoch:  89%|████████▉ | 8/9 [1:24:56<10:23, 623.06s/it]constract vocabulary based on frequency
# train data: 23066
# test  data: 855
# vocab: 18828
# class: 5
epoch 8 augment best acc:0.408145
Epoch: 100%|██████████| 9/9 [1:31:08<00:00, 547.64s/it]Epoch: 100%|██████████| 9/9 [1:31:08<00:00, 607.60s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_0.5', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30692
# test  data: 855
# vocab: 20416
# class: 5
epoch 0 augment best acc:0.40362
Epoch:  11%|█         | 1/9 [17:36<2:20:53, 1056.68s/it]constract vocabulary based on frequency
# train data: 30769
# test  data: 855
# vocab: 20388
# class: 5
epoch 1 augment best acc:0.408597
Epoch:  22%|██▏       | 2/9 [27:53<1:47:53, 924.76s/it] constract vocabulary based on frequency
# train data: 30752
# test  data: 855
# vocab: 19996
# class: 5
epoch 2 augment best acc:0.407692
Epoch:  33%|███▎      | 3/9 [39:13<1:25:08, 851.45s/it]constract vocabulary based on frequency
# train data: 30741
# test  data: 855
# vocab: 20099
# class: 5
epoch 3 augment best acc:0.422624
Epoch:  44%|████▍     | 4/9 [49:31<1:05:05, 781.14s/it]constract vocabulary based on frequency
# train data: 30808
# test  data: 855
# vocab: 19685
# class: 5
epoch 4 augment best acc:0.396833
Epoch:  56%|█████▌    | 5/9 [1:00:05<49:08, 737.08s/it]constract vocabulary based on frequency
# train data: 30762
# test  data: 855
# vocab: 19768
# class: 5
epoch 5 augment best acc:0.422172
Epoch:  67%|██████▋   | 6/9 [1:11:07<35:44, 714.67s/it]constract vocabulary based on frequency
# train data: 30724
# test  data: 855
# vocab: 19817
# class: 5
epoch 6 augment best acc:0.40181
Epoch:  78%|███████▊  | 7/9 [1:19:50<21:54, 657.20s/it]constract vocabulary based on frequency
# train data: 30793
# test  data: 855
# vocab: 19641
# class: 5
epoch 7 augment best acc:0.41448
Epoch:  89%|████████▉ | 8/9 [1:28:09<10:09, 609.62s/it]constract vocabulary based on frequency
# train data: 30763
# test  data: 855
# vocab: 19552
# class: 5
epoch 8 augment best acc:0.404525
Epoch: 100%|██████████| 9/9 [1:35:06<00:00, 551.81s/it]Epoch: 100%|██████████| 9/9 [1:35:06<00:00, 634.04s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=7, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_4_7_1.0', sample_num=3, sample_ratio=4, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:09 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:09 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:09 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:09 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:09 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30753
# test  data: 855
# vocab: 24215
# class: 5
epoch 0 augment best acc:0.422172
Epoch:  11%|█         | 1/9 [14:09<1:53:19, 849.92s/it]constract vocabulary based on frequency
# train data: 30737
# test  data: 855
# vocab: 23290
# class: 5
epoch 1 augment best acc:0.393665
Epoch:  22%|██▏       | 2/9 [25:48<1:33:51, 804.45s/it]constract vocabulary based on frequency
# train data: 30735
# test  data: 855
# vocab: 22621
# class: 5
epoch 2 augment best acc:0.41267
Epoch:  33%|███▎      | 3/9 [37:46<1:17:52, 778.68s/it]constract vocabulary based on frequency
# train data: 30780
# test  data: 855
# vocab: 22154
# class: 5
epoch 3 augment best acc:0.405882
Epoch:  44%|████▍     | 4/9 [50:35<1:04:37, 775.57s/it]constract vocabulary based on frequency
# train data: 30764
# test  data: 855
# vocab: 21849
# class: 5
epoch 4 augment best acc:0.408145
Epoch:  56%|█████▌    | 5/9 [1:02:47<50:50, 762.65s/it]constract vocabulary based on frequency
# train data: 30752
# test  data: 855
# vocab: 21823
# class: 5
epoch 5 augment best acc:0.396833
Epoch:  67%|██████▋   | 6/9 [1:13:44<36:32, 730.78s/it]constract vocabulary based on frequency
# train data: 30706
# test  data: 855
# vocab: 21885
# class: 5
epoch 6 augment best acc:0.409955
Epoch:  78%|███████▊  | 7/9 [1:21:58<21:59, 659.97s/it]constract vocabulary based on frequency
# train data: 30763
# test  data: 855
# vocab: 21500
# class: 5
epoch 7 augment best acc:0.408597
Epoch:  89%|████████▉ | 8/9 [1:30:26<10:14, 614.20s/it]constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 21497
# class: 5
epoch 8 augment best acc:0.40724
Epoch: 100%|██████████| 9/9 [1:39:04<00:00, 585.37s/it]Epoch: 100%|██████████| 9/9 [1:39:04<00:00, 660.48s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_0.5', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=0.5, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30696
# test  data: 855
# vocab: 18979
# class: 5
epoch 0 augment best acc:0.39638
Epoch:  11%|█         | 1/9 [13:40<1:49:27, 820.89s/it]constract vocabulary based on frequency
# train data: 30789
# test  data: 855
# vocab: 18871
# class: 5
epoch 1 augment best acc:0.391403
Epoch:  22%|██▏       | 2/9 [24:52<1:30:32, 776.07s/it]constract vocabulary based on frequency
# train data: 30705
# test  data: 855
# vocab: 18630
# class: 5
epoch 2 augment best acc:0.395023
Epoch:  33%|███▎      | 3/9 [36:04<1:14:28, 744.79s/it]constract vocabulary based on frequency
# train data: 30814
# test  data: 855
# vocab: 18649
# class: 5
epoch 3 augment best acc:0.399548
Epoch:  44%|████▍     | 4/9 [47:27<1:00:31, 726.28s/it]constract vocabulary based on frequency
# train data: 30753
# test  data: 855
# vocab: 18424
# class: 5
epoch 4 augment best acc:0.393665
Epoch:  56%|█████▌    | 5/9 [56:55<45:14, 678.72s/it]  constract vocabulary based on frequency
# train data: 30749
# test  data: 855
# vocab: 18547
# class: 5
epoch 5 augment best acc:0.411312
Epoch:  67%|██████▋   | 6/9 [1:05:54<31:51, 637.09s/it]constract vocabulary based on frequency
# train data: 30781
# test  data: 855
# vocab: 18517
# class: 5
epoch 6 augment best acc:0.411765
Epoch:  78%|███████▊  | 7/9 [1:16:00<20:54, 627.48s/it]constract vocabulary based on frequency
# train data: 30736
# test  data: 855
# vocab: 18479
# class: 5
epoch 7 augment best acc:0.397285
Epoch:  89%|████████▉ | 8/9 [1:25:47<10:15, 615.43s/it]constract vocabulary based on frequency
# train data: 30765
# test  data: 855
# vocab: 18379
# class: 5
epoch 8 augment best acc:0.408597
Epoch: 100%|██████████| 9/9 [1:34:53<00:00, 594.55s/it]Epoch: 100%|██████████| 9/9 [1:34:53<00:00, 632.57s/it]
Namespace(bert_model='bert-base-uncased', data_dir='datasets', do_lower_case=False, gpu=6, learning_rate=5e-05, max_seq_length=64, num_train_epochs=9.0, output_dir='aug_data_3_6_6_1.0', sample_num=3, sample_ratio=6, seed=42, task_name='stsa.fine', temp=1.0, train_batch_size=32, warmup_proportion=0.1)
10/27/2019 01:49:06 - WARNING - pytorch_pretrained_bert.tokenization -   The pre-trained model you are loading is an uncased model but you have set `do_lower_case` to False. We are setting `do_lower_case=True` for you but you may want to check this behavior.
10/27/2019 01:49:08 - INFO - pytorch_pretrained_bert.tokenization -   loading vocabulary file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.pytorch_pretrained_bert/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-1
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] too smart to ignore but a little too smug ##ly superior to like , this could be a movie that ends up slapping its target audience in the face by shooting itself in the foot . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 2205 6047 2000 8568 2021 1037 2210 2205 20673 2135 6020 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 2993 1999 1996 3329 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 2205 103 2000 8568 103 1037 2210 103 20673 2135 103 2000 2066 1010 2023 2071 2022 1037 3185 2008 4515 2039 22021 2049 4539 4378 1999 1996 2227 2011 5008 103 1999 1996 103 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 6047 -1 -1 2021 -1 -1 2205 -1 -1 6020 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 2993 -1 -1 3329 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:08 - INFO - __main__ -   *** Example ***
10/27/2019 01:49:08 - INFO - __main__ -   guid: train-2
10/27/2019 01:49:08 - INFO - __main__ -   tokens: [CLS] rai ##mi and his team could n ' t have done any better in bringing the story of spider - man to the big screen . [SEP]
10/27/2019 01:49:08 - INFO - __main__ -   init_ids: 101 15547 4328 1998 2010 2136 2071 1050 1005 1056 2031 2589 2151 2488 1999 5026 1996 2466 1997 6804 1011 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_ids: 101 15547 4328 1998 2010 2136 2071 2136 1005 1056 2031 103 2151 2488 1999 5026 1996 2466 1997 6804 103 2158 2000 1996 2502 3898 1012 102 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   input_mask: 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   segment_ids: 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
10/27/2019 01:49:08 - INFO - __main__ -   masked_lm_labels: -1 -1 -1 1998 -1 -1 -1 1050 -1 -1 -1 2589 -1 -1 -1 -1 -1 -1 -1 -1 1011 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
10/27/2019 01:49:13 - INFO - __main__ -   ***** Running training *****
10/27/2019 01:49:13 - INFO - __main__ -     Num examples = 7689
10/27/2019 01:49:13 - INFO - __main__ -     Batch size = 32
10/27/2019 01:49:13 - INFO - __main__ -     Num steps = 2162
constract vocabulary based on frequency
# train data: 7689
# test  data: 855
# vocab: 16581
# class: 5
before augment best acc:0.391855
Epoch:   0%|          | 0/9 [00:00<?, ?it/s]constract vocabulary based on frequency
# train data: 30746
# test  data: 855
# vocab: 21197
# class: 5
epoch 0 augment best acc:0.39276
Epoch:  11%|█         | 1/9 [16:21<2:10:48, 981.04s/it]constract vocabulary based on frequency
# train data: 30718
# test  data: 855
# vocab: 20371
# class: 5
epoch 1 augment best acc:0.415837
Epoch:  22%|██▏       | 2/9 [27:50<1:44:15, 893.66s/it]constract vocabulary based on frequency
# train data: 30726
# test  data: 855
# vocab: 19835
# class: 5
epoch 2 augment best acc:0.420362
Epoch:  33%|███▎      | 3/9 [38:44<1:22:10, 821.77s/it]constract vocabulary based on frequency
# train data: 30770
# test  data: 855
# vocab: 19831
# class: 5
epoch 3 augment best acc:0.40181
Epoch:  44%|████▍     | 4/9 [48:14<1:02:10, 746.18s/it]constract vocabulary based on frequency
# train data: 30752
# test  data: 855
# vocab: 19541
# class: 5
epoch 4 augment best acc:0.40543
Epoch:  56%|█████▌    | 5/9 [58:14<46:49, 702.31s/it]  constract vocabulary based on frequency
# train data: 30771
# test  data: 855
# vocab: 19711
# class: 5
epoch 5 augment best acc:0.392308
Epoch:  67%|██████▋   | 6/9 [1:07:14<32:41, 653.72s/it]constract vocabulary based on frequency
# train data: 30761
# test  data: 855
# vocab: 19560
# class: 5
epoch 6 augment best acc:0.408145
Epoch:  78%|███████▊  | 7/9 [1:16:37<20:52, 626.36s/it]constract vocabulary based on frequency
# train data: 30758
# test  data: 855
# vocab: 19549
# class: 5
epoch 7 augment best acc:0.401357
Epoch:  89%|████████▉ | 8/9 [1:24:32<09:40, 580.85s/it]constract vocabulary based on frequency
# train data: 30745
# test  data: 855
# vocab: 19514
# class: 5
epoch 8 augment best acc:0.371041
Epoch: 100%|██████████| 9/9 [1:31:45<00:00, 536.74s/it]Epoch: 100%|██████████| 9/9 [1:31:45<00:00, 611.77s/it]
